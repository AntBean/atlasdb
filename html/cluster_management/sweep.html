

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>AtlasDB Sweep Job &mdash; AtlasDB develop documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/release-notes.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="AtlasDB develop documentation" href="../index.html"/>
        <link rel="up" title="Cluster Management" href="index.html"/>
        <link rel="next" title="Background Sweep" href="sweep/background-sweep.html"/>
        <link rel="prev" title="Dropwizard bundle" href="dropwizard-bundle.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> AtlasDB
          

          
          </a>

          
            
            
              <div class="version">
                develop
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schemas/index.html">Schemas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transactions/index.html">Transactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Cluster Management</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="backup-restore.html">Backup and Restore</a></li>
<li class="toctree-l2"><a class="reference internal" href="clis.html">Command Line Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="console.html">Console</a></li>
<li class="toctree-l2"><a class="reference internal" href="dropwizard-bundle.html">Dropwizard bundle</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">AtlasDB Sweep Job</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sweep/background-sweep.html">Background Sweep</a></li>
<li class="toctree-l3"><a class="reference internal" href="sweep/sweep-cli.html">AtlasDB Sweep Cli</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/index.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes/index.html">Releases</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">AtlasDB</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Cluster Management</a> &raquo;</li>
      
    <li>AtlasDB Sweep Job</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/palantir/atlasdb/blob/develop/docs/source/cluster_management/sweep.rst" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="atlasdb-sweep-job">
<span id="sweep"></span><h1>AtlasDB Sweep Job<a class="headerlink" href="#atlasdb-sweep-job" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">AtlasDB sweep is currently an experimental feature, and is disabled by default. If you are interested in testing it, please contact the AtlasDB team.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Running the Sweep Job while taking a Backup can cause <strong>SEVERE DATA CORRUPTION</strong> to your Backup.</p>
</div>
<p>Under normal usage, the data written to the key value service backing AtlasDB is never updated or deleted.
When a row in AtlasDB is &#8220;updated&#8221;, a new version of the row with a higher timestamp is written.
The old row is left untouched. When that row is later read, only the version with the higher timestamp is returned.
Deletions in AtlasDB are similar; in practice they are the same as updates with an empty value.</p>
<p>To prevent an AtlasDB database from growing in size indefinitely, old versions of rows can be deleted through a process called sweeping.
At a high level, this works by periodically scanning the database for rows with multiple versions and deleting the older versions from the database.</p>
<div class="section" id="reasons-to-sweep">
<h2>Reasons to Sweep<a class="headerlink" href="#reasons-to-sweep" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><dl class="first docutils">
<dt>Freeing up Disk Space</dt>
<dd><ul class="first last simple">
<li>Putting large amounts of data into cells that are updated creates tables that hold onto data that isn&#8217;t used. These tables are good candidates to sweep if you want to reclaim disk space.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Improving Performance</dt>
<dd><ul class="first last simple">
<li>Making many edits to the same row will leave behind many tombstoned entries, so it&#8217;s advantageous to sweep these tables to increase performance.</li>
</ul>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="ways-to-sweep">
<h2>Ways to Sweep<a class="headerlink" href="#ways-to-sweep" title="Permalink to this headline">¶</a></h2>
<p>Under normal use, the sweep job is intended to run at a constant interval as a background process that does not consume significant system resources.
Older AtlasDB instances with high data scale and months/years of user activity will likely have a large number of accumulated cells that are eligible for sweeping (i.e. a lot of unused data in AtlasDB that has never been swept).
In this case, consider manually sweeping specific tables to reduce the number of unused cells that have accumulated over time.</p>
<div class="section" id="background-sweep">
<h3>Background Sweep<a class="headerlink" href="#background-sweep" title="Permalink to this headline">¶</a></h3>
<p>For more information on how to set up a regular sweep job on your system, check out the <a class="reference internal" href="sweep/background-sweep.html#background-sweep"><span class="std std-ref">Background Sweep</span></a> documentation.</p>
</div>
<div class="section" id="targeted-sweep">
<h3>Targeted Sweep<a class="headerlink" href="#targeted-sweep" title="Permalink to this headline">¶</a></h3>
<p>If there are specific tables that have built up over time to a large size, you might consider running the targeted sweep job.
For more information about how to do this, check out our documentation on the <a class="reference internal" href="sweep/sweep-cli.html#atlas-sweep-cli"><span class="std std-ref">AtlasDB Sweep Cli</span></a>.</p>
<div class="toctree-wrapper compound">
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sweep/background-sweep.html" class="btn btn-neutral float-right" title="Background Sweep" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dropwizard-bundle.html" class="btn btn-neutral" title="Dropwizard bundle" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Palantir Technologies.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'develop',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>